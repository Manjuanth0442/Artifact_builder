{"type": "PlanScript", "uri": null, "category": null, "eTag": null, "created": null, "modified": null, "id": "87c19fa0-0308-44a5-b2dc-6b4ca5741a95", "name": "HPE-RHEL-ssh", "description": "Enables/Disables SSH and Enables Selinux Security", "status": null, "state": null, "planType": "deploy", "content": "# (c) Copyright 2018-2019 Hewlett Packard Enterprise Development LP\n#\n# Licensed under the Apache License, Version 2.0 (the \"License\");\n# you may not use this file except in compliance with the License.\n# You may obtain a copy of the License at http://www.apache.org/licenses/LICENSE-2.0\n#\n# Unless required by applicable law or agreed to in writing, software distributed\n# under the License is distributed on an \"AS IS\" BASIS, WITHOUT WARRANTIES OR\n# CONDITIONS OF ANY KIND, either express or implied. See the License for the\n# specific language governing permissions and limitations under the License.\n\n# Script to Enable/Disable SSH and add valid ssh users\n\nupload -<<END /EFI/HPE/isdeploy/scripts/08ssh_service.bash\n#!/bin/bash\n# This script was loaded by HPE Image Streamer\nexec 1> >(logger -s -t $(basename $0)) 2>&1\n\nssh=@SSH:Enable@\nssh=$(echo \"$ssh\" | tr '[:upper:]' '[:lower:]')\n\necho \"Starting manage-ssh-service using setting: $ssh\"\n\nif [ $ssh == enable ]\nthen\n\t\n\techo \"Enabling sshd to start at boot\"\n\tsystemctl enable sshd\n    \n\techo \"Disabling Firewald\"\n\n\tsystemctl disable firewalld.service\n      service firewalld stop\n\n\techo \"modifying /etc/ssh/sshd_config\"\n\tcat <<-CONF>>/etc/ssh/sshd_config\n\t#\n\t#The following was added by HPE Image Streamer:\n\tPermitRootLogin yes\n\tCONF\n\t\n\techo \"Restarting sshd\"\n\tsystemctl restart sshd\nelse\n\techo \"Stopping sshd service\"\n\tsystemctl stop sshd\n\n\techo \"Disabling sshd from starting at boot\"\n\tsystemctl disable sshd\nfi \n\necho \"Finished manage-ssh-service script\"\n\nexit 0\nEND", "customAttributes": null, "hpProvided": true, "dependentArtifacts": null}